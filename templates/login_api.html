{% extends 'index.html' %}



{% block content %}

<body>
    <div class="container">
        <h1>Login Here !!!</h1>
        <form method="POST">
           

            <div class="container mt-3">
              {% for i in msg %}
              <div class="alert alert-danger" role="alert">
                {{ i }}
                </div>
              {% endfor %}
          </div>
            
            <label for="Username"
            >Username</label>
            
            <input 
            type="text"
            name="username"
            id="username"
            
            class="form-control"
            >

            <label for="password"
            >Password</label>
            
            <input 
            type="password"
            name="password"
            id="password"
            
            class="form-control"
            >
            <div class="mb-3">

            </div>
            
          </form>

          <div class="mb-3">
            <button  type="submit" class="btn btn-primary mt-4" onclick="insert_peso()">Login</button>
          </div>

    </div>

    <script type="text/javascript">
        function insert_peso(){
            var data = {}
            // var id = document.getElementById("trans_id").value
            data["username"] = document.getElementById("username").value
            data["password"] = document.getElementById("password").value
            
            console.log(data)

            

            fetch("/token", {
            method:'POST', 
            headers: {"Content-Type": "application/x-www-form-urlencoded"},
            body: JSON.stringify('grant_type=&username${data["username"]}=&password=${data["password"]}cope=&client_id=&client_secret=')
                })
                .then(function (response) {
                    // Save the response status in a variable to use later.
                    fetch_status = response.status;
                    // Handle success
                    // eg. Convert the response to JSON and return
                    return response.json();
                }) 
                .then(function (json) {
                    // Check if the response were success
                    if (fetch_status == 200) {
                        // Use the converted JSON
                        // window.alert("Your Data has been Updated");
                        // window.location.assign("/dollar-bill/");
                        console.log(json);
                    }
                })
                .catch(function (error){
                    // Catch errors
                    window.alert(error);
                    console.log(error);
                });
        }
        

    </script>




</body>


{% endblock %}