
{% extends 'index.html' %}



{% block content %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css" />

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<body>
    <div class="container">
        <h2>
            EMPLOYEE TRANSACTIONS
        </h2>
    </div>
   
   <div class="container">

        <div class="container mt-3">
            <!-- Button trigger modal -->
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#insertEquipmentRental">
                Insert Rental
            </button>

            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#rentalList">
                Rental List
            </button>

            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#rentalReportList">
                Rental Report List
            </button>

    
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#RentalChart">
                Rental Chart
            </button>
            
            
            <br><br>

            <button type="button" class="btn btn-success" data-toggle="modal" data-target="#insertDieselTransaction">
                Insert Diesel
            </button>

            <button type="button" class="btn btn-success" data-toggle="modal" data-target="#dieselList">
                Diesel List
            </button>
            

            <button type="button" class="btn btn-success" data-toggle="modal" data-target="#sumDieselList">
                Diesel Report List
            </button>
            
            <br><br>


            <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#insertTonnage">
                Insert Tons
            </button>

            <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#tonnageList">
                Tonnage List
            </button>
            

            <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#tonnageReportList">
                Tonnage Report List
            </button>
            
            <br><br>

            <button type="button" class="btn btn-info" data-toggle="modal" data-target="#insertcost">
                Insert Cost
            </button>

            <button type="button" class="btn btn-info" data-toggle="modal" data-target="#costList">
                Cost List
            </button>

           

            
            
        </div>
            <!-- Modal Rental -->
            <div class="modal fade" id="insertEquipmentRental" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Insert Rental Transaction</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    </div>

                    
                    <div class="modal-body">

                        <label for="TransactionDate" >Transaction Date</label><br>
                        <input
                            type="date"
                            name="trans_date"
                            id="trans_date"
                            class="form-control"
                            >
                        </input>

                        <label for="Equipment" >EUR</label>
                        <input
                            type="text"
                            name="eur_form"
                            id="eur_form"
                           
                            class="form-control"
                            >
                        </input>  

                        <label for="Equipment" >Equipment</label>
                        <input
                            type="text"
                            name="equipment_id"
                            id="equipment_id"
                           
                            class="form-control"
                            >
                        </input>  

                        <label for="Equipment" >Time IN</label>
                            <input
                                type="datetime-local"
                                name="start"
                                id="start"
                                class="form-control"
                                >
                            </input>  
                        <label for="Equipment" >Time OUT</label>
                            <input
                                type="datetime-local"
                                name="end"
                                id="end"
                                class="form-control"
                                >
                            </input>  
                        <!-- <label for="Equipment" >Total Rental Hours Computation</label>
                            <input
                            type="number"
                            name="totalHours"
                            id="totalHours"
                            step="0.01"
                            class="form-control"
                            
                            >
                            </input>   -->

                        <label for="Total Hours" >Total Hours</label>
                            <input
                            type="number"
                            name="total_rental_hour"
                            id="total_rental_hour"
                            step="0.01"
                            class="form-control"
                            
                            >
                            </input>  

                        <label for="Rental Rate" >Rental Rate</label>
                            <input
                                type="number"
                                name="rental_rate"
                                id="rental_rate"
                                step="0.01"
                                
                                class="form-control"
                                
                                >
                            </input> 

                        
                            <input
                                type="number" hidden
                                name="rental_amount"
                                id="rental_amount"
                                class="form-control"
                                
                                >
                            </input>  

                        
                        <label for="Amount" >Amount</label>
                            <input
                                type="text"
                                name="rental_amount2"
                                id="rental_amount2"
                                class="form-control"
                                
                                >
                            </input>  
                        
            
                    
                    </div>
                    <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" id="buttonSave" onclick="insertRental()"class="btn btn-primary">Save</button>
                    <!-- <button type="button" name ="save_button" id="save_button" class="btn btn-success">Save</button> -->
                    <button type="submit"  onclick="html_table_excel_rental('xlsx')" class="btn btn-secondary">
                            Export Excel
                            <i class="fas fa-database"></i>
                        </button>
                    </div>
                </div>
                </div>
            </div>

            <!-- Modal Insert Diesel Transactions -->
        <div class="modal fade" id="insertDieselTransaction" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add Diesel Transaction</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>

                
                <div class="modal-body">

                    <label for="TransactionDate"
                    >TransactionDate</label>
                    
                    <input 
                    type="date"
                    name="transDateDiesel"
                    id="transDateDiesel"
                    
                    class="form-control"
                    >

                
                    <label for="EquipmentID"
                    >Equipment ID</label>
                    
                    <input 
                    type="text"
                    name="equipmentIdDiesel"
                    id="equipmentIdDiesel"
                    
                    class="form-control"
                    >


                    

                    <label for="WithSlpi"
                    >Withdrawal Slip</label>
                    
                    <input 
                    type="text"
                    name="withdrawalSlipDiesel"
                    id="withdrawalSlipDiesel"
                    
                    class="form-control"
                    >

                   

                    <label for="TotalLiters"
                        >Total Liters</label>
                        
                        <input 
                        type="number"
                        name="totalliters"
                        id="totalliters"
                        step="0.01"
                        class="form-control"
                        >

                    <label for="Price"
                        >Price</label>
                        
                        <input 
                        type="number"
                        name="priceDiesel"
                        id="priceDiesel"
                        step="0.01"
                        class="form-control"
                        >

                    
    
                        <input 
                        type="number" hidden
                        name="totalAmountDiesel"
                        id="totalAmountDiesel"
                        step="0.01"
                        class="form-control">


                    <label for="Total Amount"
                        >Total Amount</label>
    
                        <input 
                        type="text"
                        name="totalAmountDiesel2"
                        id="totalAmountDiesel2"
                       
                        class="form-control">

                    
                  
        
                
                </div>
                <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="submit" onclick="insertDiesel()" class="btn btn-primary">Save</button>
                <!-- <button type="button" name ="save_button" id="save_button" class="btn btn-success">Save</button> -->
                </div>
            </div>
            </div>
        </div>


         <!-- this is for Rental Modal List -->
         <div class="modal fade" id="rentalList" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Rental List</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>

        <div class="modal-body">
            <div class="container mt-3">
                <label for="TransactionDate" >Date From</label>
                <input
                    type="date"
                    name="datefrom"
                    id="datefrom"
                    >
                </input>  

            <label for="TransactionDate" >Date To</label>
                <input
                    type="date"
                    name="dateto"
                    id="dateto"
                    >
                </input>  

            <label for="Equipment" >Equipment</label>
                <input
                    type="text"
                    name="equipment_id_searchRental"
                    id="equipment_id_searchRental"
                    >
                </input>  

                <button type="submit"  onclick="display_data()" class="btn btn-success">
                    Search Data
                    <i class="fas fa-database"></i>
                </button>

                <button type="submit"  onclick="html_table_excel_rental('xlsx')" class="btn btn-secondary">
                    Export Excel
                    <i class="fas fa-database"></i>
                </button>


                <!-- <button type="submit"  onclick="printPageRentalList()" class="btn btn-warning">
                    Print 
                    <i class="fas fa-database"></i>
                </button> -->
                

                <button type="button"  id="printRentalPDF"  class="btn btn-warning">
                    Print Test
                    <i class="fas fa-database"></i>
                </button>

        </div>
        <div  class="container mt-3 table-responsive">
            <table id="myTable" class="table table-bordered"  style="text-align: center;">
                <thead class="table-dark">
                
                        <td>ID</td>
                        <td>Date</td>
                        <td>Equipment ID</td>
                        <td>EUR</td>
                        <td>Total Hour</td>
                        <td>Rental Rate</td>
                        <td>Total Amount</td>
                        <td>Running Bal</td>
                        <td>Action</td>
                        
                    </tr>
                </thead>
                <tbody id="table_body">
                
                        
                        <tr>
                            
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    
                    
                </tbody>

            

                </table>

        
            </div>

            
        </div>


            <div class="modal-footer">
                    
                <!-- <button type="button" name ="save_button" id="save_button" class="btn btn-success">Save</button> -->
                </div>
            </div>
            </div>
        </div>


        <!-- this is for Rental  REPORT Modal List -->
        <div class="modal fade" id="rentalReportList" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Rental List LD GLOBAL LEGACY INC</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>

        <div class="modal-body">
            <div class="container mt-3">
                <label for="TransactionDate" >Date From</label>
                <input
                    type="date"
                    name="datefromRental2"
                    id="datefromRental2"
                    >
                </input>  

            <label for="TransactionDate" >Date To</label>
                <input
                    type="date"
                    name="datetoRental2"
                    id="datetoRental2"
                    >
                </input>  

            <label for="Equipment" >Equipment</label>
                <input
                    type="text"
                    name="equipment_id_searchRental2"
                    id="equipment_id_searchRental2"
                    >
                </input> 
                
            

                <button type="submit"  onclick="display_RentalSum()" class="btn btn-success">
                    Search Data
                    <i class="fas fa-database"></i>
                </button>

                <button type="button" id="printTotalRental"  class="btn btn-warning">
                    Print PDF
                    <i class="fas fa-database"></i>
                </button>

                

        </div>
        <div  class="container mt-3 table-responsive">
            <table id="myTable" class="table table-bordered"  style="text-align: center;">
                <thead class="table-dark">
                
                        
                        <td>Equipment ID</td>
                        <td>Total Hour</td>
                        <td>Rental Rate</td>
                        <td>Total Amount</td>
                        <td hidden>Total Amount</td>
                       
                        
                    </tr>
                </thead>
                <tbody id="table_bodyRentalReport">
                
                        
                        <tr>
                            
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td hidden></td>
                            
                        </tr>
                    
                    
                </tbody>

            

                </table>

        
            </div>

            
        </div>


            <div class="modal-footer">
                    
                <!-- <button type="button" name ="save_button" id="save_button" class="btn btn-success">Save</button> -->
            <label for="Equipment" >Total Hours</label>
            <input
                type="text"
                name="fter_totalHour"
                id="fter_totalHour"
                style="text-align: right;"
                >
            </input> 

            <input
                type="number" hidden
                name="fter_test"
                id="fter_test"
                style="text-align: right;"
                >
            </input> 

            <label for="Equipment" >Total Amount</label>
            <input
                type="text"
                name="fter_totalAmountl"
                id="fter_totalAmountl"
                style="text-align: right;"
                >
            </input> 
            
            </div>
            </div>
            </div>
        </div>





       <!-- Modal for Diesel List -->

        <div class="modal fade" id="dieselList" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog  modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Diesel Transaction List</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>

                
                <div class="modal-body">
                    <div class="container mt-3">
                        <label for="dateFrom"
                        >From</label>
                        
                            <input 
                            type="date"
                            name="dateFromDiesel"
                            id="dateFromDiesel"
                           
                            >

                    
                        <label for="dateTo"
                        >To</label>
                        
                            <input 
                            type="date"
                            name="dateToDiesel"
                            id="dateToDiesel"
                           
                            >
                        <label for="Equipment"
                            >Equipment</label>
                            <input 
                            type="text"
                            name="equipmentSearchDieselTrans"
                            id="equipmentSearchDieselTrans"
                            
                            >
                        
                        <button type="submit" onclick="displayDieselData()" class="btn btn-primary">Search</button>

                        <button type="submit"  onclick="html_table_excel('xlsx')" class="btn btn-secondary">
                            Export Excel
                            <i class="fas fa-database"></i>
                        </button>
                    </div>

                    <div  class="container mt-3 table-responsive">
                        <table id="myTableDiesel" class="table table-bordered"  style="text-align: center;">
                            <thead class="table-dark">
                            
                                    <td>ID</td>
                                    <td>Trans Date</td>
                                    <td>Equipment ID</td>
                                    <td>Withdrawal Slip</td>
                                    <td>Liters</td>
                                    <td>Price</td>
                                    <td>Total Amount</td>
                                    <td>Cummulative Amount</td>
                                </tr>
                            </thead>
                            <tbody id="table_body_diesel">
                               
                                    
                                    <tr>
                                        
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                      
                                    </tr>
                                   
                                
                            </tbody>
            
                           
            
                        </table>
            
                        
                            
                            
                    </div>
        
                  
           </div>
        

  
                </div>
                <div class="modal-footer">
                
                <!-- <button type="button" name ="save_button" id="save_button" class="btn btn-success">Save</button> -->
                </div>
            </div>
            </div>
        </div>


        <!-- Modal for Sum Diesel List -->

        <div class="modal fade" id="sumDieselList" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog  modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Diesel Sum List</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>

                
                <div class="modal-body">
                    <div class="container mt-3">
                        <label for="dateFrom"
                        >From</label>
                        
                            <input 
                            type="date"
                            name="dateFromDiesel_sum"
                            id="dateFromDiesel_sum"
                           
                            >

                    
                        <label for="dateTo"
                        >To</label>
                        
                            <input 
                            type="date"
                            name="dateToDiesel_sum"
                            id="dateToDiesel_sum"
                           
                            >
                        <label for="Equipment"
                            >Equipment</label>
                            <input 
                            type="text"
                            name="equipmentSearchDieselTrans_sum"
                            id="equipmentSearchDieselTrans_sum"
                            
                            >
                        
                        <button type="submit" onclick="displayDieselDataSum()" class="btn btn-primary">Search</button>

                        <!-- <button type="submit"  onclick="html_table_excel('xlsx')" class="btn btn-secondary">
                            Export Excel
                            <i class="fas fa-database"></i>
                        </button> -->
                    </div>

                    <div  class="container mt-3 table-responsive">
                        <table id="myTableDiesel" class="table table-bordered"  style="text-align: center;">
                            <thead class="table-dark">
                            
                                    
                                    <td>Equipment ID</td>
                                    <td>Liters</td>
                                    <td>Total Amount</td>
                                    <td hidden>Total Amount2</td>
                                    
                                </tr>
                            </thead>
                            <tbody id="table_body_diesel_sum">
                               
                                    
                                    <tr>
                                        
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td hidden></td>
                                      
                                    </tr>
                                   
                                
                            </tbody>
            
                           
            
                        </table>
            
                        
                            
                            
                    </div>
        
                  
           </div>
        

  
                </div>
                <div class="modal-footer">
                
                <!-- <button type="button" name ="save_button" id="save_button" class="btn btn-success">Save</button> -->
                <label for="Equipment" >Total Hours</label>
                <input
                    type="text"
                    name="fter_totaLiter"
                    id="fter_totaLiter"
                    style="text-align: right;"
                    >
                </input> 
    
               
    
                <label for="Equipment" >Total Amount</label>
                <input
                    type="text"
                    name="fter_totalAmountlDiesel"
                    id="fter_totalAmountlDiesel"
                    style="text-align: right;"
                    >
                </input> 
                  
            </div>
            </div>
            </div>
        </div>






        <!-- Modal Insert Tonnage Transactions -->
        <div class="modal fade" id="insertTonnage" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add Tonnage Transaction</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>

                
                <div class="modal-body">
                    <label >
                        Date
                    </label>
                    <input 
                        type="date" 
                        name="transDate_Tons"
                        id="transDate_Tons"
                        
                        class="form-control"
                        
                        >
            
                    <label >
                        Equipment ID
                    </label>
                        <input 
                            type="text" hidden
                            name="equipmentID_Tons2"
                            id="equipmentID_Tons2"
                            
                            class="form-control"
                            
                        >

                    <select name="equipmentID_Tons" id="equipmentID_Tons"class="form-control"
                    >

                    {% for result in equipmentData %}
                        <option value="{{ result.equipment_id }}">{{ result.equipment_id }}</option>
                    {% endfor %} 

                

                </select>
            
                    <label >
                        Trip Ticket
                        </label>
                        <input 
                            type="text" 
                            name="tripTicket_Tons"
                            id="tripTicket_Tons"
                            
                            class="form-control"
                            
                        >
            
                    <label >
                        Total Trip
                        </label>
                        <input 
                            type="number" 
                            name="totalTrip_Tons"
                            id="totalTrip_Tons"
                            step="0.0"
                            class="form-control"
                            
                        >

                    <label >
                        Backhoe
                    </label>
                    <select name="Backhoe" id="Backhoe"class="form-control"
                    >
                        <option value= --------->------SELECT-------</option>
                        <option value="BH 01">BH 01</option>
                        <option value="BH 02">BH 02</option>
                        <option value="BH 03">BH 03</option>
                        <option value="TX 1202">TX 1202</option>
                        <option value="TX 1204">TX 1204</option>
                    </select>
                    
                    <label >
                        Bucket
                    </label>
                        <input 
                            type="number" 
                            name="bucket_Tons"
                            id="bucket_Tons"
                            step="0.0"
                            class="form-control"
                            
                        >

            
            
                    <label >
                        Total Tonnage
                        </label>
                        <input 
                            type="number" 
                            name="totalTons_Tons"
                            id="totalTons_Tons"
                            step="0.0"
                            class="form-control"
                            
                        >
            
                    <label >
                        Rate
                        </label>
                        <input 
                            type="number" 
                            name="rate_Tons"
                            id="rate_Tons"
                            step="0.0"
                            value= 35
                            class="form-control"
                            
                        >
            
                        <label >
                        Amount
                        </label>
                        <input 
                            type="number" hidden
                            name="amount_Tons"
                            id="amount_Tons"
                            step="0.0"
                            class="form-control"
                            
                        >

                        <input 
                            type="text" 
                            name="amount_Tons2"
                            id="amount_Tons2"
                            
                            class="form-control"
                            
                        >
            
                    <label >
                        Driver/Operator
                        </label>
                        <input 
                            type="text" 
                            name="driver_operator_Tons"
                            id="driver_operator_Tons"
                            
                            class="form-control"
                            
                        >
                    
                    
            
                </div>
                <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="submit" onclick="inserttonnageHauling()" class="btn btn-primary">Save</button>
                <!-- <button type="button" name ="save_button" id="save_button" class="btn btn-success">Save</button> -->
                </div>
            </div>
            </div>
        </div>



        <!-- this is for Tonnage  REPORT Modal List -->
        <div class="modal fade" id="tonnageReportList" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Rental List</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>

        <div class="modal-body">
            <div class="container mt-3">
                <label for="TransactionDate" >Date From</label>
                <input
                    type="date"
                    name="datefromTonnage2"
                    id="datefromTonnage2"
                    >
                </input>  

            <label for="TransactionDate" >Date To</label>
                <input
                    type="date"
                    name="dateToTonnage2"
                    id="dateToTonnage2"
                    >
                </input>  

            <label for="Equipment" >Equipment</label>
                <input
                    type="text"
                    name="equipment_id_searchTonnage2"
                    id="equipment_id_searchTonnage2"
                    >
                </input> 
                
            

                <button type="submit"  onclick="display_TonnageSum()" class="btn btn-success">
                    Search Data
                    <i class="fas fa-database"></i>
                </button>


                <button type="button" onclick="makePDF()" class="btn btn-warning">
                    Print Table
                    <i class="fas fa-database"></i>
                </button>

                

        </div>
        <div  class="container mt-3 table-responsive">
            <table id="myTableMakePDF" class="table table-bordered"  style="text-align: center;">
                <thead class="table-dark">
                
                        
                        <td>Equipment ID</td>
                        <td>Total Tonnage</td>
                        <td>Rental Rate</td>
                        <td>Amount</td>
                        <td hidden>Total Amount</td>
                       
                        
                    </tr>
                </thead>
                <tbody id="table_bodyTonnageReport">
                
                        
                        <tr>
                            
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td hidden></td>
                            
                        </tr>
                    
                    
                </tbody>

            

                </table>

        
            </div>

            
        </div>


            <div class="modal-footer">
                    
                <!-- <button type="button" name ="save_button" id="save_button" class="btn btn-success">Save</button> -->
            <label for="Equipment" >Total Tonnage</label>
            <input
                type="Text"
                name="fter_totalTons"
                id="fter_totalTons"
                style="text-align: right;"
                >
            </input> 

           

            <label for="Equipment" >Total Amount</label>
            <input
                type="text"
                name="fter_totalAmountlTons"
                id="fter_totalAmountlTons"
                style="text-align: right;"
                >
            </input> 
            
            </div>
            </div>
            </div>
        </div>



        

        <div class="modal fade" id="tonnageList" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog  modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Tonnage Transaction List</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>

                
                <div class="modal-body">
                    <div class="container mt-3">
                        <label for="dateFrom"
                        >From</label>
                        
                       
                        
                            <input 
                            type="date"
                            name="dateFrom_Tons"
                            id="dateFrom_Tons"
                           
                            >
                
                        <label for="dateTo"
                        >Date To</label>
                        
                            <input 
                            type="date"
                            name="dateTo_Tons"
                            id="dateTo_Tons"
                            
                            >
                
                        <label for="dateTo"
                        >Equipment ID</label>
                        
                            <input 
                            type="text"
                            name="equipmentIDSearch_Tons"
                            id="equipmentIDSearch_Tons"
                            
                            >
                        
                        <button type="submit" onclick="displayTonnageData()" class="btn btn-primary">Search</button>

                        <button type="submit"  onclick="html_table_excel_tonnage('xlsx')" class="btn btn-secondary">
                            Export Excel
                            <i class="fas fa-database"></i>
                        </button>
                        <button type="submit" onclick="displayTonnageData_print()" class="btn btn-warning">
                            PDF
                            <i class="fas fa-database"></i>
                        </button>
                    </div>

                    <div  class="container mt-3 table-responsive">
                        <table id="myTableTons" class="table table-bordered"  style="text-align: center;">
                            <thead class="table-dark">
                                <tr>
                                    <td>ID</td>
                                    <td>Date</td>
                                    <td>Equipment ID</td>
                                    <td>Trip Ticket</td>
                                    <td>Total Trip</td>
                                    <td>Total Tonnage</td>
                                    <td>Rate</td>
                                    <td>Amount</td>
                                    <td>Cum Total</td>
                                    <td>Driver Operator</td>
                                    <td>User</td>
                                    <td>Action</td>
                                </tr>
                            </thead>
                            <tbody id="table_body_tonnage">
                               
                                    
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                   
                                
                            </tbody>
            
                           
            
                        </table>
            
                        
                            
                            
                    </div>
        
                  
           </div>
        

  
                </div>
                <div class="modal-footer">
                
                <!-- <button type="button" name ="save_button" id="save_button" class="btn btn-success">Save</button> -->
                </div>
            </div>
            </div>
        </div>





        <!-- Modal Insert Cost Transactions -->
        <div class="modal fade" id="insertcost" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add Cost Transaction</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>

                
                <div class="modal-body">
                    <label >
                        Date
                    </label>
                    <input 
                        type="date" 
                        name="transDate_cost"
                        id="transDate_cost"
                        
                        class="form-control"
                        
                        >
            
                    <label >
                        Equipment ID
                        </label>
                        <input 
                            type="text" 
                            name="equipment_id_cost"
                            id="equipment_id_cost"
                            
                            class="form-control"
                            
                        >
            
                    <label >
                        Salaries
                        </label>
                        <input 
                            type="number" 
                            name="salaries"
                            id="salaries"
                            step="0.0"
                            class="form-control"
                            onkeyup="getTotalamount();"
                        >
            
                    <label >
                        Fuel
                        </label>
                        <input 
                            type="number" 
                            name="fuel"
                            id="fuel"
                            step="0.0"
                            class="form-control"
                            onkeyup="getTotalamount();"
                        >
            
            
                    <label >
                        Oil & Lubes
                        </label>
                        <input 
                            type="number" 
                            name="oil_lubes"
                            id="oil_lubes"
                            step="0.0"
                            class="form-control"
                            onkeyup="getTotalamount();"
                        >
            
                    <label >
                        Mechanical Supplies
                        </label>
                        <input 
                            type="number" 
                            name="mechanicalSupplies"
                            id="mechanicalSupplies"
                            step="0.0"
                            class="form-control"
                            onkeyup="getTotalamount();"
                        >
            
                    <label >
                        Repair Maintenance
                        </label>
                        <input 
                            type="number" 
                            name="repairMaintenance"
                            id="repairMaintenance"
                            step="0.0"
                            class="form-control"
                            onkeyup="getTotalamount();"
                        >
            
                    <label >
                        Meals
                        </label>
                        <input 
                            type="number" 
                            name="meals"
                            id="meals"
                            step="0.0"
                            class="form-control"
                            onkeyup="getTotalamount();"
                        >
            
                    <label >
                        Transpo
                        </label>
                        <input 
                            type="number" 
                            name="transpo"
                            id="transpo"
                            step="0.0"
                            class="form-control"
                            onkeyup="getTotalamount();"
                        >
                    
                    <label >
                        Tires
                        </label>
                        <input 
                            type="number" 
                            name="tires"
                            id="tires"
                            step="0.0"
                            class="form-control"
                            onkeyup="getTotalamount();"
                        >
            
                    <label >
                        Amortization
                        </label>
                        <input 
                            type="number" 
                            name="amortization"
                            id="amortization"
                            step="0.0"
                            class="form-control"
                            onkeyup="getTotalamount();"
                        >
            
                    <label >
                        Others
                        </label>
                        <input 
                            type="number" 
                            name="others"
                            id="others"
                            step="0.0"
                            class="form-control"
                            onkeyup="getTotalamount();"
                        >
            
                    <label >
                        Total Amount
                        </label>
                        <input 
                            type="number" hidden
                            name="costAmount"
                            id="costAmount"
                            step="0.1"
                            class="form-control"
                            
                        >

                        <input 
                            type="text" 
                            name="totalAmount_cost2"
                            id="totalAmount_cost2"
                           
                            class="form-control"
                            
                        >
            
                    
                    
            
                </div>
                <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="submit" onclick="insertCosting()" class="btn btn-primary">Save</button>
                <!-- <button type="button" name ="save_button" id="save_button" class="btn btn-success">Save</button> -->
                </div>
            </div>
            </div>
        </div>


        <div class="modal fade" id="costList" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog  modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Cost Transaction List</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>

                
                <div class="modal-body">
                    <div class="container mt-3">
                        <label for="dateFrom"
                        >From</label>
                        
                       
                        
                            <input 
                            type="date"
                            name="dateFrom_cost"
                            id="dateFrom_cost"
                           
                            >
                
                        <label for="dateTo"
                        >Date To</label>
                        
                            <input 
                            type="date"
                            name="dateTo_cost"
                            id="dateTo_cost"
                            
                            >
                
                        <label for="dateTo"
                        >Equipment ID</label>
                        
                            <input 
                            type="text"
                            name="equipmentIDSearch_cost"
                            id="equipmentIDSearch_cost"
                            
                            >
                        
                        <button type="submit" onclick="displayCostData()" class="btn btn-primary">Search</button>

                        <button type="submit"  onclick="html_table_excel_cost('xlsx')" class="btn btn-secondary">
                            Export Excel
                            <i class="fas fa-database"></i>
                        </button>
                    </div>

                    <div  class="container mt-3 table-responsive">
                        <table id="myTableTons" class="table table-bordered"  style="text-align: center;">
                            <thead class="table-dark">
                                <tr>
                                    <td>Date</td>
                                    <td>Equipment ID</td>
                                    <td>Salaries</td>
                                    <td>Fuel</td>
                                    <td>Oil & Lubes</td>
                                    <td>Mech. Supplies</td>
                                    <td>Repair & Main</td>
                                    <td>Meals</td>
                                    <td>Transpo</td>
                                    <td>Tires</td>
                                    <td>Amortization</td>
                                    <td>Others</td>
                                    <td>Total Cost</td>
                                    <td>Action</td>
                                </tr>
                            </thead>
                            <tbody id="table_body_cost">
                               
                                    
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        
                                    </tr>
                                   
                                
                            </tbody>
            
                           
            
                        </table>
            
                        
                            
                            
                    </div>
        
                  
           </div>
        

  
                </div>
                <div class="modal-footer">
                
                <!-- <button type="button" name ="save_button" id="save_button" class="btn btn-success">Save</button> -->
                </div>
            </div>
            </div>
        </div>


<!-- ==============================================Chart JS============================================== -->
<!-- Modal Rental -->
<div class="modal fade" id="RentalChart" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
        <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Rental Chart</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
        </div>

        
        <div class="modal-body">

            <label for="TransactionDate" >Date From</label>
            <input
                type="date"
                name="datefromChartRental"
                id="datefromChartRental"
                
                >
            </input>

        

            <label for="TransactionDate" >Date to</label>
            <input
                type="date"
                name="datetoChartRental"
                id="datetoChartRental"
               
                >
            </input>

            

            <button type="submit" id="buttonSave" onclick="RentalChart()"class="btn btn-primary">Search</button>
            <div  class="container mt-3">
                <canvas id="myChart" width="400" height="400"></canvas>
            </div>
            
        
        </div>
        <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <!-- <button type="submit" id="buttonSave" onclick="insertRental()"class="btn btn-primary">Save</button> -->
        <!-- <button type="button" name ="save_button" id="save_button" class="btn btn-success">Save</button> -->
        <!-- <button type="submit"  onclick="html_table_excel_rental('xlsx')" class="btn btn-secondary">
                Export Excel
                <i class="fas fa-database"></i>
            </button> -->
        </div>
    </div>
    </div>
</div>


                
<!-- ===========================================for Java Scripts Function=========================================== -->

            <script>
                function printPageRentalList() {
                    window.print();
                    }
            </script>

            <script type="text/javascript">

                async function RentalChart() {
                    datefrom = document.getElementById('datefromChartRental').value;
                dateto = document.getElementById('datetoChartRental').value;


                const search_url = `/api-get-rentalChart-employeLogin/?datefrom=${datefrom}&dateto=${dateto}`;
                
                const response = await fetch(search_url);
                const data = await response.json();

                console.log(data)

                var labels = data.map(function(item) {
                    return item.transaction_date;
                    });

                var values = data.map(function(item) {
                    return item.totalHours;
                    });

                    var ctx = document.getElementById('myChart').getContext('2d');
                    var chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                        label: 'Daily Data',
                        data: values,
                        borderColor: 'rgb(255, 99, 132)',
                        fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        title: {
                        display: true,
                        text: 'Daily Data Graph'
                        },
                        scales: {
                        xAxes: [{
                            type: 'time',
                            distribution: 'linear',
                            time: {
                            unit: 'day',
                            displayFormats: {
                                day: 'MMM D'
                            }
                            }
                        }],
                        yAxes: [{
                            ticks: {
                            beginAtZero: true
                            }
                        }]
                        }
                    }
                    });

                    
                }
                

            </script>
         



        
        
            <!-- this is for auto complete input  -->

            <script>

                $( function() {
                    
                    $( "#equipment_id" ).autocomplete({
                    source: "/api-search-autocomplete-equipment-rizal/",
                    minLength: 1
                    });



                } );
    
    
            </script>
    <!-- This function is for auto generate of Rental Rate -->
            <script>
                $(document).ready(function() {
                $("#equipment_id").on("keyup", async function(event) {
                    // check if Enter key was pressed
                    if (event.keyCode === 13 || event.keyCode === 9) {
                    // trigger button click event
                        var equipment_id = document.getElementById("equipment_id").value

                        const search_url = `/api-get-rental-rate-employeLogin/?equipment_id=${equipment_id}`;


                        const responce =  await fetch(search_url)
                        const data =  await responce.json();
                        console.log(data)
                        

                        if (data.length === 0){
                            window.alert(`No ID store for ${equipment_id}`)
                        }else{
                            var rental_rate = data[0].rental_rate
                        
                            document.getElementById("rental_rate").value = rental_rate
                            calculateRentalAmount()
                            calculateProductRental()
                            

                        }
                   
                    }
                });
            });       

               
                                

            </script>

               


            <script>

                $( function() {
                    
                    $( "#equipmentIdDiesel" ).autocomplete({
                    source: "/api-search-autocomplete-equipment-rizal/",

                    });
                } );


            </script>


            <script>

                $( function() {
                    
                    $( "#equipmentID_Tons2" ).autocomplete({
                    source: "/api-search-autocomplete-equipment-rizal/"
                    });
                } );


            </script>

            <script>

                $( function() {
                    
                    $( "#equipment_id_cost" ).autocomplete({
                    source: "/api-search-autocomplete-equipment-rizal/"
                    });
                } );


            </script>

<!-- ================================This is for inserting Rizal Equipment Rental By employee Login=================== -->
            
            <!-- This function is for  -->
            <script>
                $(document).ready(function() {
                $('#start, #end').change(function() {
                    const startDate = new Date($('#start').val()).getTime();
                    const endDate = new Date($('#end').val()).getTime();
                    const elapsed = endDate - startDate;
                    const elapsedInSeconds = (elapsed / 1000) / 60 / 60;
                    // console.log(startDate,elapsedInSeconds)

                    totalHours = elapsedInSeconds.toFixed(2)
                    $('#total_rental_hour').val(totalHours);
                    calculateRentalAmount()
                    calculateProductRental()
                });
                });
            </script>
            
            
            
            
            
            <script type="text/javascript">
                // Define an async function to insert equipment
                async function insertRental() {
                // Get the values of the input fields
                const data = {
                    transaction_date: document.getElementById("trans_date").value,
                    equipment_id: document.getElementById("equipment_id").value,
                    total_rental_hour: document.getElementById("total_rental_hour").value,
                    rental_rate: document.getElementById("rental_rate").value,
                    rental_amount: document.getElementById("rental_amount").value,
                    eur_form:  document.getElementById("eur_form").value,
                
                    
                };
                console.log(data)
                // Use the fetch API to send the POST request

                            
                const search_url_SEARCH = `/api-get-rentalCheck-employeLogin/?dateSearch=${data.transaction_date}&equipment_id=${data.equipment_id}&eur_form=${data.eur_form}&total_rental_hour=${data.total_rental_hour}`;


                const responceSEARCH = await fetch(search_url_SEARCH)
                const dataSEARCH = await responceSEARCH.json();
                console.log(dataSEARCH)

                if (dataSEARCH.length > 0) {
                    window.alert("Your data has already EXIST please check Rental List");
                    
                    }

                else if(data.transaction_date == '' || data.equipment_id == '' || data.total_rental_hour == '',
                            data.rental_rate == '' || data.rental_amount == '',data.eur_form =='')
                            {
                                window.alert("Please fill up Blank flieds/field"); 
                            }
                else {

                    try {
                            const response = await fetch(`/api-insert-employee-rizal-rental/`, {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify(data)
                            });
                    
                            // Check if the response was successful
                            if (response.status === 200) {
                            window.alert("Your data has been saved");
                            console.log(data);
                            
                            let equipment_id = document.getElementById("equipment_id").value;
                            let total_rental_hour = document.getElementById("total_rental_hour").value;
                            let rental_rate = document.getElementById("rental_rate").value;
                            let rental_amount = document.getElementById("rental_amount").value;
                            let eur_form = document.getElementById("eur_form").value;

                            total_rental_hour.value = "" ;
                            rental_rate.value = "";
                            rental_amount.value = "";


                            // window.location.assign("/employee-rizal-equipment-rental/");
                            
                            } else if (response.status === 401) {
                            window.alert("Unauthorized credential. Please login");
                            }
                        } catch (error) {
                            // Catch any errors and log them to the console
                            window.alert(error);
                            console.log(error);
                        }
                                        
                        }
                
                }
            </script>



<!-- ====================================This is for computation of Total amount==================================== -->
        <script>
            $(document).ready(function() {
               $('#total_rental_hour, #rental_rate').on('input', function() {
                calculateProductRental();
               });
               });

               function calculateProductRental() {

               var rental_rate = parseFloat($('#rental_rate').val());
               
               var total_rental_hour = parseFloat($('#total_rental_hour').val());
               
               
               var product = total_rental_hour * rental_rate;

               var product2 = parseFloat(product).toFixed(2)
               $('#rental_amount').val(product2);
               }

           

        </script>

<!-- ============================ This function is for computaion of rental Amount with Comma ================ -->
            <script type="text/javascript">
                                // Get input fields and result element
                var input1 = document.getElementById("total_rental_hour");
                var input2 = document.getElementById("rental_rate");
                

                // Add event listener to inputs
                input1.addEventListener("input", calculateRentalAmount);
                input2.addEventListener("input", calculateRentalAmount);

                function calculateRentalAmount() {
                // Get input field values
                var value1 = parseFloat(input1.value);
                var value2 = parseFloat(input2.value);

                // Calculate product
                var product = value1 * value2;

                let comma = product.toLocaleString("en-US");

                document.getElementById("rental_amount2").value = comma;

                }

            </script>



<!-- ====================================This function is for Displaying Rental Data to Table========================= -->
        <script type="text/javascript">

            // const rental_url =search_url ;
            async function display_data(){
                var datefrom = document.getElementById("datefrom").value
                var dateto = document.getElementById("dateto").value
                var equipmentID = document.getElementById("equipment_id_searchRental").value

                const search_url = `/api-get-rental-rizal-employee_login/?datefrom=${datefrom}&dateto=${dateto}&equipment_id=${equipmentID}`;


                const responce = await fetch(search_url)
                const data = await responce.json();
                console.log(data)

                if (data.length === 0) {
                        window.alert('No Data available');
                    };
                
                
                if (responce.status === 200){
                    let tableData="";
                    data.map((values)=>{
                        tableData+= ` <tr>
                                    <td>${values.id}</td>
                                    <td>${values.transaction_date}</td>
                                    <td>${values.equipment_id}</td>
                                    <td>${values.eur_form}</td>
                                    <td>${values.total_rental_hour}</td>
                                    <td>${values.rental_rate}</td>
                                    <td>${values.rental_amount}</td>
                                    <td>${values.totalAmount}</td>

                                   
                                   
                                
                                </tr>`;
                    });
                    document.getElementById("table_body").innerHTML=tableData;

                }else if (responce.status === 401){
                    window.alert("Unauthorized Credentials Please Log in")
                }
            
            }

        </script>

            


        <script type="text/javascript">
            async function printRental2(){
                var datefrom = document.getElementById("datefrom").value
                var dateto = document.getElementById("dateto").value
                var equipmentID = document.getElementById("equipment_id_searchRental").value

                const search_url = `/api-get-rental-rizal-employee_login/?datefrom=${datefrom}&dateto=${dateto}&equipment_id=${equipmentID}`;

                const response = await fetch(search_url)
                const data = await response.json();
                console.log(data)

                const dataArray = [];

                for (let i of data){
                    dataArray.push(i);

                    // Create a new jsPDF instance
                    var doc = new jsPDF();
                    // / Define the table headers
                    var headers = [["ID", "TransDate", "Equipment ID",
                                    "EUR","Total Hours","Rental Rate",
                                        "Rental Amount","TotalAmount"]];
                    var data1 = dataArray

                    // Create a table using the headers and data
                    doc.autoTable({
                    head: headers,
                    body: data1
                    });

                    // Save the PDF document
                    doc.save("report.pdf");

                }

                console.log(dataArray);
            }  

        </script>

        <!-- This function is for exporting Excel of Rental transaction -->
            <script>
                function html_table_excel_rental(type){
                    var data = document.getElementById('table_body');
                    var file = XLSX.utils.table_to_book(data,{sheet: "sheet1"});
                    XLSX.write(file,{ booktype: type, bookSST: true, type: 'base64'});
                    XLSX.writeFile(file, 'rentalList.' + type);

                }

                
            </script>

            <!-- This  function is for displaying Sum of Rental Data  -->
            <script type="text/javascript">

                // const rental_url =search_url ;
                async function display_RentalSum(){
                    var datefrom = document.getElementById("datefromRental2").value
                    var dateto = document.getElementById("datetoRental2").value
                    var equipmentID = document.getElementById("equipment_id_searchRental2").value
                

                    const search_url = `/api-get-rentalSum-rizal-employeeLogin/?datefrom=${datefrom}&dateto=${dateto}&equipment_id=${equipmentID}`;


                    const responce = await fetch(search_url)
                    const data = await responce.json();
                    console.log(data)

                    if (data.length === 0) {
                            window.alert('No Data available');
                        };
                    
                    
                    if (responce.status === 200){
                        let tableData="";
                        data.map((values)=>{
                            tableData+= ` <tr>
                                        
                                        <td>${values.equipmentId}</td>
                                        <td>${values.totalHours}</td>
                                        <td>${values.rentalRate}</td>
                                        <td style="text-align: right;">${values.totalAmount}</td>
                                        <td hidden>${values.totalAmount2}</td>
                                    
                                    
                                    </tr>`;
                        });
                        document.getElementById("table_bodyRentalReport").innerHTML=tableData;
                        summaryRentalTotal()

                    }else if (responce.status === 401){
                        window.alert("Unauthorized Credentials Please Log in")
                    }
                
                }

            </script>


            <!-- this is for total footer -->
            <script>
           
               
                function summaryRentalTotal() {
                    var $table = $("#table_bodyRentalReport");
                    var sumhours = 0;
                    var sumTotalAmount = 0;

                    $table.find("tr").each(function(i, row) {
                        
                        sumhours += parseFloat($(row).find("td:eq(1)").text());
                        sumTotalAmount += parseFloat($(row).find("td:eq(4)").text());
                        console.log()
                    });
                    
                    var sumTotalHoursComa = sumhours.toLocaleString("en-US");
                    var sumTotalAmount2Coma = sumTotalAmount.toLocaleString("en-US");

                    $("#fter_totalHour").val(sumTotalHoursComa);
                    $("#fter_totalAmountl").val(sumTotalAmount2Coma);
                    }
            </script>

            <script type="text/javascript">
                document.getElementById('printTotalRental').addEventListener('click', printTotalRental);

                function printTotalRental() {
                window.print();
                }
            </script>



<!-- ====================================This is for computation of Total amount Diesel==================================== -->
        <script>
            $(document).ready(function() {
            $('#totalliters, #priceDiesel').on('input', function() {
                calculateProduct_diesel();
            });
            });

            function calculateProduct_diesel() {

            var totalLiters = parseFloat($('#totalliters').val());
            
            var priceDiesel = parseFloat($('#priceDiesel').val());
            
            
            var product = totalLiters * priceDiesel;
           
            var product2 = parseFloat(product).toFixed(2)
           
            $('#totalAmountDiesel').val(product2);
            }

        


        </script>

<!-- ============================ This function is for computaion of Diesel Total Amount with Comma ================ -->
            <script>
                $(document).ready(function() {
                $('#totalliters, #priceDiesel').on('input', function() {
                    calculateProduct2();
                });
                });

                function calculateProduct2() {

                var totalLiters = $('#totalliters').val();
                
                var priceDiesel = $('#priceDiesel').val();
                
                
                var product = totalLiters * priceDiesel;

                // var floatValue = product.toLocaleString('en-US');
                const stringNumber = product.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
                $('#totalAmountDiesel2').val(stringNumber);
                }




            </script>

<!-- ================================This is for inserting Diesel  By employee Login=================== -->
                <script type="text/javascript">
                    // Define an async function to insert equipment
                    async function insertDiesel() {
                    // Get the values of the input fields
                    const data = {
                        transaction_date: document.getElementById("transDateDiesel").value,
                        equipment_id: document.getElementById("equipmentIdDiesel").value,
                        withdrawal_slip: document.getElementById("withdrawalSlipDiesel").value,
                        use_liter: document.getElementById("totalliters").value,
                        price: document.getElementById("priceDiesel").value,
                        amount: document.getElementById("totalAmountDiesel").value,
                        
                        
                    };
                    console.log(data.transaction_date)

                    // Use the fetch API to send the POST request
                    try {

                        const search_url_SEARCH = `/api-get-rizal-dieselCheck-employeeLogin/?transaction_date=${data.transaction_date}&equipment_id=${data.equipment_id}&withdrawal_slip=${data.withdrawal_slip}`;


                        const responceSEARCH = await fetch(search_url_SEARCH)
                        const dataSEARCH = await responceSEARCH.json();
                        console.log(dataSEARCH)

                        if (dataSEARCH.length > 0) {
                            window.alert("Your data has already EXIST please check Diesel List");
                            
                            } else {
                                const response = await fetch(`/api-insert-rizalDiesel-employeeLogin/`, {
                                method: "POST",
                                headers: { "Content-Type": "application/json" },
                                body: JSON.stringify(data)
                                });

                                // Check if the response was successful
                                if (response.status === 200) {
                                window.alert("Your data has been saved");
                                console.log(data);
                                window.location.assign("/employee-rizal-equipment-rental/");
                                
                                } else if (response.status === 401) {
                                window.alert("Unauthorized credential. Please login");
                                };
                            }

                        
                        
                    } catch (error) {
                        // Catch any errors and log them to the console
                        window.alert(error);
                        console.log(error);
                    }
                    }
                </script>

                   
<!-- ====================================This function is for Displaying Diesel Data to Table========================= -->
            <script type="text/javascript">

                // const rental_url =search_url ;
                async function displayDieselData(){
                    var datefrom = document.getElementById("dateFromDiesel").value
                    var dateto = document.getElementById("dateToDiesel").value
                    var equipmentID = document.getElementById("equipmentSearchDieselTrans").value

                    const search_url = `/api-get-diesel-rizal-employeeLogin/?datefrom=${datefrom}&dateto=${dateto}&equipment_id=${equipmentID}`;


                    const responce = await fetch(search_url)
                    const data = await responce.json();
                    console.log(data)

                    if (data.length === 0) {
                            window.alert('No Data available');
                        };
                    
                    
                    if (responce.status === 200){
                        let tableData="";
                        data.map((values)=>{
                            tableData+= ` <tr>
                                        <td>${values.id}</td>
                                        <td>${values.transaction_date}</td>
                                        <td>${values.equipment_id}</td>
                                        <td>${values.withdrawal_slip}</td>
                                        <td>${values.use_liter}</td>
                                        <td>${values.price}</td>
                                        <td>${values.amount}</td>
                                        <td>${values.totalAmount}</td>
                                    
                                    
                                    </tr>`;
                        });
                        document.getElementById("table_body_diesel").innerHTML=tableData;

                    }else if (responce.status === 401){
                        window.alert("Unauthorized Credentials Please Log in")
                    }
                
                }

            </script>


        <script>
            function html_table_excel(type){
                var data = document.getElementById('table_body_diesel');
                var file = XLSX.utils.table_to_book(data,{sheet: "sheet1"});
                XLSX.write(file,{ booktype: type, bookSST: true, type: 'base64'});
                XLSX.writeFile(file, 'dieselList.' + type);

            }

            
        </script>



        <!-- This  function is for displaying Sum of Diesel Data  -->
        <script type="text/javascript">

            // const rental_url =search_url ;
            async function displayDieselDataSum(){
                var datefrom = document.getElementById("dateFromDiesel_sum").value
                var dateto = document.getElementById("dateToDiesel_sum").value
                var equipmentID = document.getElementById("equipmentSearchDieselTrans_sum").value
            

                const search_url = `/api-get-rizal-sumDiesel-employeeLogin/?datefrom=${datefrom}&dateto=${dateto}&equipment_id=${equipmentID}`;


                const responce = await fetch(search_url)
                const data = await responce.json();
                console.log(data)

                if (data.length === 0) {
                        window.alert('No Data available');
                    };
                
                
                if (responce.status === 200){
                    let tableData="";
                    data.map((values)=>{
                        tableData+= ` <tr>
                                    
                                    
                                    <td>${values.equipment_id}</td>
                                    <td>${values.use_liter}</td>
                                    <td>${values.amount}</td>
                                    <td hidden>${values.amount2}</td>
                                
                                
                                </tr>`;
                    });
                    document.getElementById("table_body_diesel_sum").innerHTML=tableData;
                    summaryDieselTotal()

                }else if (responce.status === 401){
                    window.alert("Unauthorized Credentials Please Log in")
                }
            
            }

        </script>


        <!-- this is for total footer -->
        <script>
       
           
            function summaryDieselTotal() {
                var $table = $("#table_body_diesel_sum");
                var sumLiters = 0;
                var sumTotalAmount = 0;

                $table.find("tr").each(function(i, row) {
                    
                    sumLiters += parseFloat($(row).find("td:eq(1)").text());
                    sumTotalAmount += parseFloat($(row).find("td:eq(3)").text());
                    
                });
                
                var sumTotalLitersComa = sumLiters.toLocaleString("en-US");
                var sumTotalAmount2Coma = sumTotalAmount.toLocaleString("en-US");

                $("#fter_totaLiter").val(sumTotalLitersComa);
                $("#fter_totalAmountlDiesel").val(sumTotalAmount2Coma);
                }
        </script>



<!-- ===================================This function is for Tonnage Employee Login============================ -->
            <!-- This function is for calculating Total Amount for Tons -->
            <script>
                $(document).ready(function() {
                $('#bucket_Tons, #totalTons_Tons').on('input', function() {
                    calculateTotalTons();
                });
                });

                function calculateTotalTons() {

                var Backhoe = $('#Backhoe').val();
                var Bucket = $('#bucket_Tons').val();
                var bachoeValue = 0
                if (Backhoe === 'BH 01' || Backhoe === 'BH 03' ){
                    bachoeValue = 2.29
                    totalTons = bachoeValue * Bucket
                    totalTons2 = parseFloat(totalTons).toFixed(2)
                    $('#totalTons_Tons').val(totalTons2);
                    calculateProduct_amountTons2()
                    calculateProduct_amountTons()
                }else if(Backhoe === 'BH 02'){
                    bachoeValue = 1.42
                    totalTons = bachoeValue * Bucket
                    totalTons2 = parseFloat(totalTons).toFixed(2)
                    $('#totalTons_Tons').val(totalTons2);
                    calculateProduct_amountTons2()
                    calculateProduct_amountTons()
                }
                else if(Backhoe === 'TX 1202' || Backhoe === 'TX 1204'){
                    bachoeValue = 1.44
                    totalTons = bachoeValue * Bucket
                    totalTons2 = parseFloat(totalTons).toFixed(2)
                    $('#totalTons_Tons').val(totalTons2);
                    calculateProduct_amountTons2()
                    calculateProduct_amountTons()
                }

               
                }

            </script>



        <!-- This function is for calculating Total Amount for Tons -->
            <script>
                $(document).ready(function() {
                $('#totalTons_Tons, #rate_Tons').on('input', function() {
                    calculateProduct_amountTons();
                });
                });

                function calculateProduct_amountTons() {

                var totalTons_Tons = $('#totalTons_Tons').val();
                
                var rate_Tons = $('#rate_Tons').val();
                
                var product = totalTons_Tons * rate_Tons;
                
                var product2 = parseFloat(product).toFixed(2)

                $('#amount_Tons').val(product2);
                }

            </script>


            <script>
               
                $(document).ready(function() {
                $('#rate_Tons, #totalTons_Tons').on('input', function() {
                    calculateProduct_amountTons2();
                });
                });

                function calculateProduct_amountTons2() {

                var totalTons_Tons = $('#totalTons_Tons').val();
                
                var rate_Tons = $('#rate_Tons').val();
                
                var product = totalTons_Tons * rate_Tons;
                
                // var floatValue = product.toLocaleString('en-US');
                const stringNumber = product.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
                $('#amount_Tons2').val(stringNumber);
                }




            </script>


            <!-- This is to insert Equipment to tvi table -->
            <script type="text/javascript">
                // Define an async function to insert equipment
                async function inserttonnageHauling() {
                // Get the values of the input fields
                const data = {
                    transDate: document.getElementById("transDate_Tons").value,
                    equipment_id: document.getElementById("equipmentID_Tons").value,
                    tripTicket: document.getElementById("tripTicket_Tons").value,
                    totalTrip: document.getElementById("totalTrip_Tons").value,
                    totalTonnage: document.getElementById("totalTons_Tons").value,
                    rate: document.getElementById("rate_Tons").value,
                    amount: document.getElementById("amount_Tons").value,
                    driverOperator: document.getElementById("driver_operator_Tons").value,
                    
                    
                };
            
                // Use the fetch API to send the POST request
                try {

                        const search_url_SEARCH = `/api-get-rizal-insertTonnageCheck-employeeLogin/?tripTicket=${data.tripTicket}`;


                        const responceSEARCH = await fetch(search_url_SEARCH)
                        const dataSEARCH = await responceSEARCH.json();
                        console.log(dataSEARCH)

                        if (dataSEARCH.length > 0) {
                            window.alert("Your data has already EXIST please check Tonnage List");
                            
                            }else if(data.amount === ''){
                                windows.alert("Check Your Field you need to press TAB from rate and wait for 3 seconds")
                            } else{
                                const response = await fetch(`/api-insert-rizalTonnage-employeeLogin/`, {
                                method: "POST",
                                headers: { "Content-Type": "application/json" },
                                body: JSON.stringify(data)
                                });
                        
                                // Check if the response was successful
                                if (response.status === 200) {
                                window.alert("Your data has been saved");
                                console.log(data);
                                window.location.assign("/employee-rizal-equipment-rental/");
                                
                                } else if (response.status === 401) {
                                window.alert("Unauthorized credential. Please login");
                                }
                            }
                    
                } catch (error) {
                    // Catch any errors and log them to the console
                    window.alert(error);
                    console.log(error);
                }
                }
            </script>


            <!-- This function is to Display List from Tonnage Transaction -->

            <script type="text/javascript">
                     async function displayTonnageData(){
                    var dateFrom = document.getElementById('dateFrom_Tons').value;
                    var dateTo = document.getElementById('dateTo_Tons').value;
                    var equipmentIDSearch = document.getElementById('equipmentIDSearch_Tons').value;
                
                const search_url = `/api-get-tonnage-rizal-employeeLogin/?datefrom=${dateFrom}&dateto=${dateTo}&equipment_id=${equipmentIDSearch}`;
    
                
                const responce = await fetch(search_url)
                const data = await responce.json();
                console.log(data)
                
                if (responce.status === 200) {
                    let tableData2="";
                    data.map((values)=>{
                        tableData2+= ` <tr>
                                    <td>${values.id}</td>
                                    <td>${values.transDate}</td>
                                    <td>${values.equipment_id}</td>
                                    <td>${values.tripTicket}</td>
                                    <td>${values.totalTrip}</td>
                                    <td>${values.totalTonnage}</td>
                                    <td>${values.rate}</td>
                                    <td>${values.amount}</td>
                                    <td>${values.totalAmount}</td>
                                    <td>${values.driverOperator}</td>
                                    <td>${values.user}</td>
                                    <td>
                                        
                                    </td>
                            
                                
                                </tr>`;
                    });
                        document.getElementById("table_body_tonnage").innerHTML=tableData2;
                    }else if (responce.status === 401){
                        window.alert("Unauthorized credential. Please login");
                    }
                
                }

                    // async function displayTonnageData() {
                    // var dateFrom = document.getElementById("dateFrom_Tons").value;
                    // var dateTo = document.getElementById("dateTo_Tons").value;
                    // var equipmentIDSearch = document.getElementById("equipmentIDSearch_Tons").value;

                    // const searchUrl = `/api-get-tonnage-rizal-employeeLogin/?datefrom=${dateFrom}&dateto=${dateTo}&equipment_id=${equipmentIDSearch}`;

                    // try {
                    //     const response = await fetch(searchUrl);
                    //     const data = await response.json();

                    //     if (response.status === 200) {
                    //     let tableData = "";
                    //     const equipmentData = {};

                    //     data.forEach((values) => {
                    //         const equipmentID = values.equipment_id;

                    //         if (!equipmentData[equipmentID]) {
                    //         equipmentData[equipmentID] = {
                    //             totalTrip: 0,
                    //             totalTonnage: 0,
                    //             amount: 0,
                    //             records: [],
                    //         };
                    //         }

                    //         equipmentData[equipmentID].totalTrip += parseFloat(values.totalTrip);
                    //         equipmentData[equipmentID].totalTonnage += parseFloat(values.totalTonnage);
                    //         equipmentData[equipmentID].amount += parseFloat(values.amount);
                    //         equipmentData[equipmentID].records.push(values);
                    //     });

                    //     for (const equipmentID in equipmentData) {
                    //         const equipment = equipmentData[equipmentID];

                    //         let recordsHTML = "";
                    //         equipment.records.forEach((values) => {
                    //         recordsHTML += `<tr>
                    //                             <td>${values.id}</td>
                    //                             <td>${values.transDate}</td>
                    //                             <td>${values.equipment_id}</td>
                    //                             <td>${values.tripTicket}</td>
                    //                             <td>${values.totalTrip}</td>
                    //                             <td>${values.totalTonnage}</td>
                    //                             <td>${values.rate}</td>
                    //                             <td>${values.amount}</td>
                    //                             <td>${values.totalAmount}</td>
                    //                             <td>${values.driverOperator}</td>
                    //                             <td>${values.user}</td>
                    //                             <td></td>
                    //                         </tr>`;
                    //         });

                    //         const formattedTotalTrip = equipment.totalTrip.toLocaleString(undefined, {
                    //         minimumFractionDigits: 2,
                    //         maximumFractionDigits: 2,
                    //         });

                    //         const formattedTotalTons = equipment.totalTonnage.toLocaleString(undefined, {
                    //         minimumFractionDigits: 2,
                    //         maximumFractionDigits: 2,
                    //         });


                    //         const formattedTotalAmount = equipment.amount.toLocaleString(undefined, {
                    //         minimumFractionDigits: 2,
                    //         maximumFractionDigits: 2,
                    //         });

                    //         tableData += `<tr>
                    //                         <td colspan="4">Total for Equipment ${equipmentID}</td>
                    //                         <td>${formattedTotalTrip}</td>
                    //                         <td>${formattedTotalTons}</td>
                    //                         <td></td>
                    //                         <td>${formattedTotalAmount}</td>
                    //                         <td></td>
                    //                         <td></td>
                    //                         <td></td>
                    //                         <td></td>
                    //                     </tr>`;
                    //         tableData += recordsHTML;
                    //     }

                    //     document.getElementById("table_body_tonnage").innerHTML = tableData;
                    //     } else if (response.status === 401) {
                    //     window.alert("Unauthorized credential. Please login");
                    //     }
                    // } catch (error) {
                    //     console.error(error);
                    //     window.alert("An error occurred while fetching data.");
                    // }
                    // }


               

            </script>
            
              


            

            

            <script type="text/javascript">
                function html_table_excel_tonnage(type){
                    var data = document.getElementById('table_body_tonnage');
                    var file = XLSX.utils.table_to_book(data,{sheet: "sheet1"});
                    XLSX.write(file,{ booktype: type, bookSST: true, type: 'base64'});
                    XLSX.writeFile(file, 'tonnageList.' + type);

                }

                
            </script>

        

        <!-- This is for printing PDF of List of Tonnage -->

            <script type="text/javascript">

                            async function displayTonnageData_print() {
                            var dateFrom = document.getElementById('dateFrom_Tons').value;
                            var dateTo = document.getElementById('dateTo_Tons').value;
                            var equipmentIDSearch = document.getElementById('equipmentIDSearch_Tons').value;

                            const search_url = `/api-get-tonnage-rizal-employeeLogin/?datefrom=${dateFrom}&dateto=${dateTo}&equipment_id=${equipmentIDSearch}`;

                            const response = await fetch(search_url);
                            const dataSet = await response.json();

                            const docDefinition = {
                                pageOrientation: 'landscape',
                                content: [
                                { text: 'LD GLOBAL LEGACY', style: 'header' },
                                { text: 'EQUIPMENT HAULING REPORT', style: 'header' },
                                { text: `Date From:  ${dateFrom}`  , style: 'header' },
                                { text: `Date   To :  ${dateTo}`  , style: 'header' },
                                { text: '\n' },
                                {
                                    table: {
                                    headerRows: 1,
                                    widths: ['auto', 'auto', 'auto', 'auto', 'auto'],
                                    body: [
                                        ['Equipment ID', 'Total Trip', 'Total Tonnage', 'Total Amount', 'Entries'],
                                        ...generateTableRows(dataSet),
                                    ],
                                    },
                                    layout: {
                                    defaultBorder: false,
                                    paddingTop: function (i, node) { return 5; },
                                    paddingBottom: function (i, node) { return 5; },
                                    },
                                },
                                ],
                                styles: {
                                header: {
                                    fontSize: 15,
                                    bold: true,
                                    alignment: 'center',
                                },
                                bodyText: {
                                    fontSize: 10,
                                    alignment: 'right',
                                },
                                entryText: {
                                    fontSize: 10,
                                },
                                },
                            };

                            function generateTableRows(dataSet) {
                                const rows = [];
                                const groupedData = groupDataByEquipment(dataSet);

                                Object.entries(groupedData).forEach(([equipmentId, equipmentData]) => {
                                rows.push([
                                    equipmentId,
                                    equipmentData.totalTrip.toLocaleString("en-US"),
                                    equipmentData.totalTonnage.toLocaleString("en-US"),
                                    equipmentData.totalAmount.toLocaleString("en-US"),
                                    generateEntriesTable(equipmentData.entries),
                                ]);
                                });
                                // equipmentData.totalAmount.toLocaleString("en-US"),
                                return rows;
                            }

                            function groupDataByEquipment(dataSet) {
                                const groupedData = {};
                                dataSet.forEach((data) => {
                                const { equipment_id, totalTrip, totalTonnage, amount } = data;
                                if (!groupedData[equipment_id]) {
                                    groupedData[equipment_id] = {
                                    totalTrip: 0,
                                    totalTonnage: 0,
                                    totalAmount: 0,
                                    entries: [],
                                    };
                                }
                                groupedData[equipment_id].totalTrip += parseFloat(totalTrip);
                                groupedData[equipment_id].totalTonnage += parseFloat(totalTonnage);
                                groupedData[equipment_id].totalAmount += parseFloat(amount);
                                groupedData[equipment_id].entries.push(data);
                                });
                                return groupedData;
                            }

                            function generateEntriesTable(entries) {
                                const body = [
                                [
                                    { text: 'ID', style: 'entryText' },
                                    { text: 'Trans Date', style: 'entryText' },
                                    { text: 'Trip Ticket', style: 'entryText' },
                                    { text: 'Total Trip', style: 'entryText' },
                                    { text: 'Total Tonnage', style: 'entryText' },
                                    { text: 'Amount', style: 'entryText' },
                                ],
                                ];

                                entries.forEach((entry) => {
                                    console.log(entries)
                                body.push([
                                    { text: entry.id.toString(), style: 'entryText' },
                                    { text: entry.transDate, style: 'entryText' },
                                    { text: entry.tripTicket, style: 'entryText' },
                                    { text: entry.totalTrip, style: 'entryText' },
                                    { text: entry.totalTonnage, style: 'entryText' },
                                    { text: entry.amount, style: 'entryText' },
                                ]);
                                });

                                return {
                                table: {
                                    widths: ['auto', 'auto', 'auto', 'auto', 'auto', 'auto'],
                                    body,
                                },
                                layout: 'lightHorizontalLines',
                                };
                            }

                            const pdfDoc = pdfMake.createPdf(docDefinition);
                            pdfDoc.download('equipment_data.pdf');
                            }


                    
            </script>
        


            <script type="text/javascript">
                async function display_TonnageSum(){
                var datefrom = document.getElementById("datefromTonnage2").value
                var dateto = document.getElementById("dateToTonnage2").value
                var equipmentID = document.getElementById("equipment_id_searchTonnage2").value
            

                const search_url = `/api-get-rizal-sumTonnage-employeeLogin/?datefrom=${datefrom}&dateto=${dateto}&equipment_id=${equipmentID}`;


                const responce = await fetch(search_url)
                const data = await responce.json();
                console.log(data)

                if (data.length === 0) {
                        window.alert('No Data available');
                    };
                
                
                if (responce.status === 200){
                    let tableData="";
                    data.map((values)=>{
                        tableData+= ` <tr>
                                    
                                    
                                    <td>${values.equipment_id}</td>
                                    <td>${values.totalTons}</td>
                                    <td>${values.totalAmount}</td>
                                    <td hidden>${values.totalAmount2}</td>
                                
                                
                                </tr>`;
                    });
                    document.getElementById("table_bodyTonnageReport").innerHTML=tableData;
                    summaryTonnageTotal()

                }else if (responce.status === 401){
                    window.alert("Unauthorized Credentials Please Log in")
                }
            
            }

                
            
            </script>


          
            <script type="text/javascript">
           
               
                function summaryTonnageTotal() {
                    var $table = $("#table_bodyTonnageReport");
                    var sumTons = 0;
                    var sumTotalAmount = 0;

                    $table.find("tr").each(function(i, row) {
                        
                        sumTons += parseFloat($(row).find("td:eq(1)").text());
                        sumTotalAmount += parseFloat($(row).find("td:eq(3)").text());
                        console.log()
                    });
                    
                    var sumTotalHoursComa = sumTons.toLocaleString("en-US");
                    var sumTotalAmount2Coma = sumTotalAmount.toLocaleString("en-US");

                    $("#fter_totalTons").val(sumTotalHoursComa);
                    $("#fter_totalAmountlTons").val(sumTotalAmount2Coma);
                    }
            </script>

            

            <script>
                function makePDF(){
                    var printMe = document.getElementById('myTableMakePDF');
                    var wme = window.open("","","width:700,height:900");
                    wme.document.write(printMe.outerHTML);
                    wme.document.close();
                    wme.focus();
                    wme.print();
                    wme.close();
                }

            </script>


<!-- ====================================Cost Transaction =============================================== -->
            <script type="text/javascript"> 
                function getTotalamount(){
                

                    var salaries = parseFloat(document.getElementById("salaries").value);
                    var fuel = parseFloat(document.getElementById("fuel").value);
                    var oil_lubes = parseFloat(document.getElementById("oil_lubes").value);
                    var mechanicalSupplies = parseFloat(document.getElementById("mechanicalSupplies").value);
                    var repairMaintenance = parseFloat(document.getElementById("repairMaintenance").value);
                    var meals = parseFloat(document.getElementById("meals").value);
                    var transpo = parseFloat(document.getElementById("transpo").value);
                    var tires = parseFloat(document.getElementById("tires").value);
                    var amortization = parseFloat(document.getElementById("amortization").value);
                    var others = parseFloat(document.getElementById("others").value);
                // totalAmount: document.getElementById("totalAmount").value,
                
                    var totalAmount;
            
                    totalAmount = (salaries + fuel + oil_lubes + mechanicalSupplies +
                                    repairMaintenance + meals + transpo +
                                    tires + amortization + others );

                    const stringNumber = totalAmount.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');

                    document.getElementById('totalAmount_cost2').value=stringNumber;	
                    document.getElementById('costAmount').value=totalAmount.toFixed(2);
                        
                    
                
                }

            </script>


             <!-- This is to insert Cost to cost table Rizal -->
            <script type="text/javascript">
                // Define an async function to insert equipment
                async function insertCosting() {
                // Get the values of the input fields
                const data = {
                    transDate: document.getElementById("transDate_cost").value,
                    equipment_id: document.getElementById("equipment_id_cost").value,
                    salaries: document.getElementById("salaries").value,
                    fuel: document.getElementById("fuel").value,
                    oil_lubes: document.getElementById("oil_lubes").value,
                    mechanicalSupplies: document.getElementById("mechanicalSupplies").value,
                    repairMaintenance: document.getElementById("repairMaintenance").value,
                    meals: document.getElementById("meals").value,
                    transpo: document.getElementById("transpo").value,
                    tires: document.getElementById("tires").value,
                    amortization: document.getElementById("amortization").value,
                    others: document.getElementById("others").value,
                    totalAmount: document.getElementById("costAmount").value,
                
                    
                };
            
                // Use the fetch API to send the POST request
                try {
                    const response = await fetch(`/api-insert-rizal-cost-employeeLogin/`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data)
                    });
            
                    // Check if the response was successful
                    if (response.status === 200) {
                    window.alert("Your data has been saved");
                    console.log(data);
                    window.location.assign("/employee-rizal-equipment-rental/");
                    
                    } else if (response.status === 401) {
                    window.alert("Unauthorized credential. Please login");
                    }
                } catch (error) {
                    // Catch any errors and log them to the console
                    window.alert(error);
                    console.log(error);
                }
                }
            </script>


            <!-- This function is for displaying Tonnage Hauling Data -->

        <script type="text/javascript">
            // const rental_url =search_url ;
            async function displayCostData(){
                var dateFrom = document.getElementById('dateFrom_cost').value;
                var dateTo = document.getElementById('dateTo_cost').value;
                var equipmentID = document.getElementById('equipmentIDSearch_cost').value;
            
            const search_url = `/api-get-rizal-cost-employeeLogin/?datefrom=${dateFrom}&dateto=${dateTo},&equipment_id=${equipmentID}`;

            
            const responce = await fetch(search_url)
            const data = await responce.json();
            console.log(data)
            
            if (responce.status === 200) {
                let tableData2="";
                data.map((values)=>{
                    tableData2+= ` <tr>
                               
                                <td>${values.transDate}</td>
                                <td>${values.equipment_id}</td>
                                <td>${values.salaries}</td>
                                <td>${values.fuel}</td>
                                <td>${values.oil_lubes}</td>
                                <td>${values.mechanicalSupplies}</td>
                                <td>${values.repairMaintenance}</td>
                                <td>${values.meals}</td>
                                <td>${values.transpo}</td>
                                <td>${values.tires}</td>
                                <td>${values.amortization}</td>
                                <td>${values.others}</td>
                                <td>${values.totalAmount}</td>


                                <td>
                                   
                                </td>
                        
                            
                            </tr>`;
                });
                    document.getElementById("table_body_cost").innerHTML=tableData2;
                }else if (responce.status === 401){
                    window.alert("Unauthorized credential. Please login");
                }
            
            }
            
            


        </script>

        <script>
            function html_table_excel_cost(type){
                var data = document.getElementById('table_body_cost');
                var file = XLSX.utils.table_to_book(data,{sheet: "sheet1"});
                XLSX.write(file,{ booktype: type, bookSST: true, type: 'base64'});
                XLSX.writeFile(file, 'cost.' + type);

            }

            
        </script>


        <script>
            async function printRenta3() {
    var datefrom = document.getElementById("datefrom").value;
    var dateto = document.getElementById("dateto").value;
    var equipmentID = document.getElementById("equipment_id_searchRental").value;
  
    const search_url = `/api-get-rental-rizal-employee_login/?datefrom=${datefrom}&dateto=${dateto}&equipment_id=${equipmentID}`;
  
    const response = await fetch(search_url);
    const data = await response.json();
    console.log(data)
  
                // Create a new PDF document definition
                const docDefinition = {
                content: [],
                
                styles: {
                    header: {
                    fontSize: 18,
                    bold: true,
                    margin: [0, 0, 0, 10],
                    },
                    tableHeader: {
                    bold: true,
                    },
                },
                };

                // Group the data by equipment ID
                const groupedData = data.reduce((acc, obj) => {
                const key = obj.equipment_id;
                if (!acc[key]) {
                    acc[key] = [];
                }
                acc[key].push(obj);
                return acc;
                }, {});

                // Generate a table for each equipment ID
                for (const equipmentId in groupedData) {
                if (groupedData.hasOwnProperty(equipmentId)) {
                    const equipmentData = groupedData[equipmentId];

                    // Add equipment ID section
                    docDefinition.content.push({ text: `Equipment ID: ${equipmentId}`, style: 'header' });

                    // Add table with data for the equipment ID
                    const table = {
                    style: 'table',
                    headerRows: 1,
                    widths: ['auto', 'auto', 'auto'],
                    body: [
                        ['Transaction Date', 'Total Rental Hour', 'Rental Amount'], // Table header
                        ...equipmentData.map((item) => [
                        item.transaction_date,
                        item.total_rental_hour,
                        item.rental_amount,
                        ]),
                    ],
                    };

                    // Calculate the total for total_rental_hour and rental_amount
                    const totalRentalHour = equipmentData.reduce((total, item) => total + parseFloat(item.total_rental_hour), 0);
                    const totalRentalAmount = equipmentData.reduce((total, item) => total + parseFloat(item.rental_amount), 0);

                    // Add total row
                    table.body.push(['Total', totalRentalHour.toFixed(2), totalRentalAmount.toFixed(2)]);

                    docDefinition.content.push(table);
                }
                }

                // Create the PDF document using pdfmake
                const pdfDocGenerator = pdfMake.createPdf(docDefinition, null);

                // Download the PDF document
                pdfDocGenerator.download('report.pdf');
  }
        </script>
       


    <script src="/static/rizal.js"></script>
        

</body>

{% endblock %}